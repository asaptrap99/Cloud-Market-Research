import numpy as np

def kernel(X1, X2, l=1.0, sigma_f=1.0):
    '''
    Isotropic squared exponential kernel. Computes 
    a covariance matrix from points in X1 and X2.
    
    Args:
        X1: Array of m points (m x d).
        X2: Array of n points (n x d).

    Returns:
        Covariance matrix (m x n).
    '''
    sqdist = np.sum(X1**2, 1).reshape(-1, 1) + np.sum(X2**2, 1) - 2 * np.dot(X1, X2.T)
    return sigma_f**2 * np.exp(-0.5 / l**2 * sqdist)


def posterior_predictive(X_s, X_train, Y_train, l=1.0, sigma_f=1.0, sigma_y=1e-8):
    '''
    Computes the suffifient statistics of the GP posterior predictive distribution 
    from m training data X_train and Y_train and n new inputs X_s.
    
    Args:
        X_s: New input locations (n x d).
        X_train: Training locations (m x d).
        Y_train: Training targets (m x 1).
        l: Kernel length parameter.
        sigma_f: Kernel vertical variation parameter.
        sigma_y: Noise parameter.
    
    Returns:
        Posterior mean vector (n x d) and covariance matrix (n x n).
    '''
    K = kernel(X_train, X_train, l, sigma_f) + sigma_y**2 * np.eye(len(X_train))
    K_s = kernel(X_train, X_s, l, sigma_f)
    K_ss = kernel(X_s, X_s, l, sigma_f) + 1e-8 * np.eye(len(X_s))
    K_inv = np.linalg.inv(K)
    
    # Equation (4)
    mu_s = K_s.T.dot(K_inv).dot(Y_train)

    # Equation (5)
    cov_s = K_ss - K_s.T.dot(K_inv).dot(K_s)
    
    return mu_s, cov_s

# Finite number of points
X = np.arange(0, 11, .2).reshape(-1, 1)

# Mean and covariance of the prior
mu = np.zeros(X.shape)
cov = kernel(X, X)
cov2 = np.array([
    [1.0000019073486328, 0.9168590307235718, 0.7066488862037659, 0.4578342139720917, 0.2493525594472885, 0.11416192352771759, 0.04393697902560234, 0.014214791357517242, 0.0038659244310110807, 0.0008838274516165257, 0.00016985676484182477, 0.000027441024940344505, 0.000003726658860614407, 4.25442152618416e-7, 4.082837179453236e-8, 3.2937148564116114e-9, 2.233635776338616e-10, 1.2733253687557955e-11, 6.101936447441836e-13, 2.4580933398769475e-14, 8.32398811964147e-16, 2.3695432370806282e-17, 5.670194886056059e-19, 1.1406159064174923e-20, 1.9287520390554007e-22],
    [0.9168590307235718, 1.0000057220458984, 0.9168573021888733, 0.7066501975059509, 0.4578342139720917, 0.24935279786586761, 0.11416203528642654, 0.04393697902560234, 0.014214824885129929, 0.003865929553285241, 0.0008838280336931348, 0.00016985709953587502, 0.000027441061320132576, 0.000003726658860614407, 4.25442152618416e-7, 4.082842508523754e-8, 3.293719075259105e-9, 2.233635776338616e-10, 1.2733253687557955e-11, 6.101936447441836e-13, 2.4580933398769475e-14, 8.32398811964147e-16, 2.36953082937144e-17, 5.670239864001867e-19, 1.1406159064174923e-20],
    [0.7066488862037659, 0.9168573021888733, 0.9999961256980896, 0.9168537259101868, 0.706646203994751, 0.45783159136772156, 0.2493516057729721, 0.11416137218475342, 0.04393675923347473, 0.014214749448001385, 0.0038659065030515194, 0.0008838233188726008, 0.00016985608090180904, 0.000027440897611086257, 0.0000037266393064783188, 4.254393388691824e-7, 4.0828208369703134e-8, 3.293701755779921e-9, 2.2336239802189795e-10, 1.2733153073596348e-11, 6.101903921376661e-13, 2.4580802955695598e-14, 8.323878005358327e-16, 2.36953082937144e-17, 5.670194886056059e-19],
    [0.4578342139720917, 0.7066501975059509, 0.9168537259101868, 1.0000009536743164, 0.9168546199798584, 0.7066481709480286, 0.45783334970474243, 0.2493520975112915, 0.11416177451610565, 0.04393693432211876, 0.014214791357517242, 0.0038659193087369204, 0.0008838256471790373, 0.00016985653201118112, 0.0000274409703706624, 0.000003726649083546363, 4.254410441717482e-7, 4.082837179453236e-8, 3.293710415519513e-9, 2.2336239802189795e-10, 1.2733219860450173e-11, 6.101920184409249e-13, 2.4580802955695598e-14, 8.32398811964147e-16, 2.3695432370806282e-17],
    [0.2493525594472885, 0.4578342139720917, 0.706646203994751, 0.9168546199798584, 1, 0.9168555736541748, 0.7066481709480286, 0.45783287286758423, 0.2493520975112915, 0.11416171491146088, 0.04393690451979637, 0.014214782044291496, 0.00386591674759984, 0.0008838256471790373, 0.0001698564155958593, 0.0000274409703706624, 0.000003726649083546363, 4.254410441717482e-7, 4.082837179453236e-8, 3.293710415519513e-9, 2.2336239802189795e-10, 1.2733219860450173e-11, 6.101903921376661e-13, 2.4580933398769475e-14, 8.32398811964147e-16],
    [0.11416192352771759, 0.24935279786586761, 0.45783159136772156, 0.7066481709480286, 0.9168555736541748, 0.9999990463256836, 0.9168546199798584, 0.7066478133201599, 0.45783311128616333, 0.2493520975112915, 0.11416167765855789, 0.04393690451979637, 0.014214782044291496, 0.00386591674759984, 0.0008838256471790373, 0.00016985653201118112, 0.0000274409703706624, 0.0000037266540857672226, 4.254410441717482e-7, 4.082837179453236e-8, 3.293710415519513e-9, 2.2336239802189795e-10, 1.2733153073596348e-11, 6.101936447441836e-13, 2.4580933398769475e-14],
    [0.04393697902560234, 0.11416203528642654, 0.2493516057729721, 0.45783334970474243, 0.7066481709480286, 0.9168546199798584, 0.9999995231628418, 0.9168546199798584, 0.7066478133201599, 0.4578332304954529, 0.24935214221477509, 0.11416171491146088, 0.043936919420957565, 0.014214791357517242, 0.00386591674759984, 0.0008838262292556465, 0.00016985676484182477, 0.00002744100675045047, 0.0000037266540857672226, 4.254410441717482e-7, 4.082837179453236e-8, 3.293710415519513e-9, 2.2336239802189795e-10, 1.2733253687557955e-11, 6.101936447441836e-13],
    [0.014214791357517242, 0.04393697902560234, 0.11416137218475342, 0.2493520975112915, 0.45783287286758423, 0.7066478133201599, 0.9168546199798584, 0.9999995231628418, 0.9168550968170166, 0.7066479921340942, 0.45783326029777527, 0.24935214221477509, 0.11416173726320267, 0.043936919420957565, 0.014214791357517242, 0.0038659218698740005, 0.0008838262292556465, 0.00016985676484182477, 0.00002744100675045047, 0.0000037266540857672226, 4.254410441717482e-7, 4.082837179453236e-8, 3.293701755779921e-9, 2.233635776338616e-10, 1.2733253687557955e-11],
    [0.0038659244310110807, 0.014214824885129929, 0.04393675923347473, 0.11416177451610565, 0.2493520975112915, 0.45783311128616333, 0.7066478133201599, 0.9168550968170166, 1, 0.9168553352355957, 0.7066482901573181, 0.45783334970474243, 0.24935223162174225, 0.11416177451610565, 0.04393693432211876, 0.014214791357517242, 0.0038659218698740005, 0.0008838262292556465, 0.00016985676484182477, 0.0000274409703706624, 0.000003726649083546363, 4.254410441717482e-7, 4.0828208369703134e-8, 3.293719075259105e-9, 2.233635776338616e-10],
    [0.0008838274516165257, 0.003865929553285241, 0.014214749448001385, 0.04393693432211876, 0.11416171491146088, 0.2493520975112915, 0.4578332304954529, 0.7066479921340942, 0.9168553352355957, 0.9999998807907104, 0.9168551564216614, 0.7066481709480286, 0.45783331990242004, 0.24935214221477509, 0.11416173726320267, 0.04393693432211876, 0.014214791357517242, 0.0038659218698740005, 0.0008838262292556465, 0.00016985653201118112, 0.0000274409703706624, 0.000003726649083546363, 4.254393388691824e-7, 4.082842508523754e-8, 3.2937148564116114e-9],
    [0.00016985676484182477, 0.0008838280336931348, 0.0038659065030515194, 0.014214791357517242, 0.04393690451979637, 0.11416167765855789, 0.24935214221477509, 0.45783326029777527, 0.7066482901573181, 0.9168551564216614, 1, 0.9168553352355957, 0.7066482901573181, 0.45783334970474243, 0.24935218691825867, 0.11416177451610565, 0.04393693432211876, 0.014214791357517242, 0.0038659218698740005, 0.0008838256471790373, 0.00016985653201118112, 0.0000274409703706624, 0.0000037266393064783188, 4.25442152618416e-7, 4.082842508523754e-8],
    [0.000027441024940344505, 0.00016985709953587502, 0.0008838233188726008, 0.0038659193087369204, 0.014214782044291496, 0.04393690451979637, 0.11416171491146088, 0.24935214221477509, 0.45783334970474243, 0.7066481709480286, 0.9168553352355957, 1, 0.9168553352355957, 0.7066482305526733, 0.45783331990242004, 0.24935218691825867, 0.11416177451610565, 0.043936919420957565, 0.014214791357517242, 0.0038659193087369204, 0.0008838256471790373, 0.00016985653201118112, 0.000027440915800980292, 0.000003726658860614407, 4.25442152618416e-7],
    [0.000003726658860614407, 0.000027441061320132576, 0.00016985608090180904, 0.0008838256471790373, 0.00386591674759984, 0.014214782044291496, 0.043936919420957565, 0.11416173726320267, 0.24935223162174225, 0.45783331990242004, 0.7066482901573181, 0.9168553352355957, 1, 0.9168553352355957, 0.7066482305526733, 0.45783331990242004, 0.24935223162174225, 0.11416173726320267, 0.043936919420957565, 0.014214782044291496, 0.00386591674759984, 0.0008838256471790373, 0.00016985608090180904, 0.000027441061320132576, 0.000003726658860614407],
    [4.25442152618416e-7, 0.000003726658860614407, 0.000027440897611086257, 0.00016985653201118112, 0.0008838256471790373, 0.00386591674759984, 0.014214791357517242, 0.043936919420957565, 0.11416177451610565, 0.24935214221477509, 0.45783334970474243, 0.7066482305526733, 0.9168553352355957, 1, 0.9168553352355957, 0.7066482305526733, 0.4578333795070648, 0.24935214221477509, 0.11416173726320267, 0.043936919420957565, 0.014214791357517242, 0.0038659193087369204, 0.0008838233188726008, 0.00016985709953587502, 0.000027441024940344505],
    [4.082837179453236e-8, 4.25442152618416e-7, 0.0000037266393064783188, 0.0000274409703706624, 0.0001698564155958593, 0.0008838256471790373, 0.00386591674759984, 0.014214791357517242, 0.04393693432211876, 0.11416173726320267, 0.24935218691825867, 0.45783331990242004, 0.7066482305526733, 0.9168553352355957, 1, 0.9168553352355957, 0.7066482901573181, 0.4578332304954529, 0.24935214221477509, 0.11416171491146088, 0.04393690451979637, 0.014214791357517242, 0.0038659065030515194, 0.0008838280336931348, 0.00016985686670523137],
    [3.2937148564116114e-9, 4.082842508523754e-8, 4.254393388691824e-7, 0.000003726649083546363, 0.0000274409703706624, 0.00016985653201118112, 0.0008838262292556465, 0.0038659218698740005, 0.014214791357517242, 0.04393693432211876, 0.11416177451610565, 0.24935218691825867, 0.45783331990242004, 0.7066482305526733, 0.9168553352355957, 0.9999998807907104, 0.9168553352355957, 0.7066479921340942, 0.4578332304954529, 0.2493520975112915, 0.11416171491146088, 0.04393693432211876, 0.014214749448001385, 0.003865929553285241, 0.0008838274516165257],
    [2.233635776338616e-10, 3.293719075259105e-9, 4.0828208369703134e-8, 4.254410441717482e-7, 0.000003726649083546363, 0.0000274409703706624, 0.00016985676484182477, 0.0008838262292556465, 0.0038659218698740005, 0.014214791357517242, 0.04393693432211876, 0.11416177451610565, 0.24935223162174225, 0.4578333795070648, 0.7066482901573181, 0.9168553352355957, 1, 0.9168550968170166, 0.7066478133201599, 0.45783311128616333, 0.2493520975112915, 0.11416177451610565, 0.04393675923347473, 0.014214824885129929, 0.0038659244310110807],
    [1.2733253687557955e-11, 2.233635776338616e-10, 3.293701755779921e-9, 4.082837179453236e-8, 4.254410441717482e-7, 0.0000037266540857672226, 0.00002744100675045047, 0.00016985676484182477, 0.0008838262292556465, 0.0038659218698740005, 0.014214791357517242, 0.043936919420957565, 0.11416173726320267, 0.24935214221477509, 0.4578332304954529, 0.7066479921340942, 0.9168550968170166, 0.9999995231628418, 0.9168546199798584, 0.7066478133201599, 0.45783287286758423, 0.2493520975112915, 0.11416137218475342, 0.04393697902560234, 0.014214791357517242],
    [6.101936447441836e-13, 1.2733253687557955e-11, 2.2336239802189795e-10, 3.293710415519513e-9, 4.082837179453236e-8, 4.254410441717482e-7, 0.0000037266540857672226, 0.00002744100675045047, 0.00016985676484182477, 0.0008838262292556465, 0.0038659218698740005, 0.014214791357517242, 0.043936919420957565, 0.11416173726320267, 0.24935214221477509, 0.4578332304954529, 0.7066478133201599, 0.9168546199798584, 0.9999995231628418, 0.9168546199798584, 0.7066481709480286, 0.45783334970474243, 0.2493516057729721, 0.11416203528642654, 0.04393697902560234],
    [2.4580933398769475e-14, 6.101936447441836e-13, 1.2733153073596348e-11, 2.2336239802189795e-10, 3.293710415519513e-9, 4.082837179453236e-8, 4.254410441717482e-7, 0.0000037266540857672226, 0.0000274409703706624, 0.00016985653201118112, 0.0008838256471790373, 0.0038659193087369204, 0.014214782044291496, 0.043936919420957565, 0.11416171491146088, 0.2493520975112915, 0.45783311128616333, 0.7066478133201599, 0.9168546199798584, 0.9999990463256836, 0.9168555736541748, 0.7066481709480286, 0.45783159136772156, 0.24935279786586761, 0.11416192352771759],
    [8.32398811964147e-16, 2.4580933398769475e-14, 6.101903921376661e-13, 1.2733219860450173e-11, 2.2336239802189795e-10, 3.293710415519513e-9, 4.082837179453236e-8, 4.254410441717482e-7, 0.000003726649083546363, 0.0000274409703706624, 0.00016985653201118112, 0.0008838256471790373, 0.00386591674759984, 0.014214791357517242, 0.04393690451979637, 0.11416171491146088, 0.2493520975112915, 0.45783287286758423, 0.7066481709480286, 0.9168555736541748, 1, 0.9168546199798584, 0.706646203994751, 0.4578342139720917, 0.2493525594472885],
    [2.3695432370806282e-17, 8.32398811964147e-16, 2.4580802955695598e-14, 6.101920184409249e-13, 1.2733219860450173e-11, 2.2336239802189795e-10, 3.293710415519513e-9, 4.082837179453236e-8, 4.254410441717482e-7, 0.000003726649083546363, 0.0000274409703706624, 0.00016985653201118112, 0.0008838256471790373, 0.0038659193087369204, 0.014214791357517242, 0.04393693432211876, 0.11416177451610565, 0.2493520975112915, 0.45783334970474243, 0.7066481709480286, 0.9168546199798584, 1.0000009536743164, 0.9168537259101868, 0.7066501975059509, 0.4578342139720917],
    [5.670194886056059e-19, 2.36953082937144e-17, 8.323878005358327e-16, 2.4580802955695598e-14, 6.101903921376661e-13, 1.2733153073596348e-11, 2.2336239802189795e-10, 3.293701755779921e-9, 4.0828208369703134e-8, 4.254393388691824e-7, 0.0000037266393064783188, 0.000027440915800980292, 0.00016985608090180904, 0.0008838233188726008, 0.0038659065030515194, 0.014214749448001385, 0.04393675923347473, 0.11416137218475342, 0.2493516057729721, 0.45783159136772156, 0.706646203994751, 0.9168537259101868, 0.9999961256980896, 0.9168573021888733, 0.7066488862037659],
    [1.1406159064174923e-20, 5.670239864001867e-19, 2.36953082937144e-17, 8.32398811964147e-16, 2.4580933398769475e-14, 6.101936447441836e-13, 1.2733253687557955e-11, 2.233635776338616e-10, 3.293719075259105e-9, 4.082842508523754e-8, 4.25442152618416e-7, 0.000003726658860614407, 0.000027441061320132576, 0.00016985709953587502, 0.0008838280336931348, 0.003865929553285241, 0.014214824885129929, 0.04393697902560234, 0.11416203528642654, 0.24935279786586761, 0.4578342139720917, 0.7066501975059509, 0.9168573021888733, 1.0000057220458984, 0.9168590307235718],
    [1.9287520390554007e-22, 1.1406159064174923e-20, 5.670194886056059e-19, 2.3695432370806282e-17, 8.32398811964147e-16, 2.4580933398769475e-14, 6.101936447441836e-13, 1.2733253687557955e-11, 2.233635776338616e-10, 3.2937148564116114e-9, 4.082842508523754e-8, 4.25442152618416e-7, 0.000003726658860614407, 0.000027441024940344505, 0.00016985686670523137, 0.0008838274516165257, 0.0038659244310110807, 0.014214791357517242, 0.04393697902560234, 0.11416192352771759, 0.2493525594472885, 0.4578342139720917, 0.7066488862037659, 0.9168590307235718, 1.0000019073486328]
]);
# Draw three samples from the prior
samples = np.random.multivariate_normal(mu.ravel(), cov, 3)
print(samples)


# for posterior predictive distribution:


# Noise free training data
X_train = np.array([-4, -3, -2, -1, 1]).reshape(-1, 1)
Y_train = np.sin(X_train)

# Compute mean and covariance of the posterior predictive distribution
mu_s, cov_s = posterior_predictive(X, X_train, Y_train)

# cov_s2 = np.array( [[0.5096275 , -0.0298808, 0.0225628 , -0.0190492, 0.0275363 , 0.0154969 , -0.0085578, -0.0030098, -0.0002323, -0.0000051],
#      [-0.0298808, 0.0028242 , -0.0029498, 0.0030078 , -0.0047707, -0.0027874, 0.0015573 , 0.0005491 , 0.0000424 , 9e-7      ],
#      [0.0225627 , -0.0029498, 0.0041684 , -0.005444 , 0.01023   , 0.0065544 , -0.0037951, -0.0013501, -0.0001044, -0.0000023],
#      [-0.0190493, 0.0030078 , -0.0054442, 0.0093551 , -0.0227219, -0.0176482, 0.0113244 , 0.0041689 , 0.0003247 , 0.0000071 ],
#      [0.0275362 , -0.0047707, 0.01023   , -0.0227218, 0.0760655 , 0.0815673 , -0.0665697, -0.0276824, -0.002249 , -0.0000497],
#      [0.0154969 , -0.0027874, 0.0065544 , -0.0176481, 0.0815673 , 0.1327186 , -0.1638026, -0.094289 , -0.0095082, -0.0002398],
#      [-0.0085578, 0.0015573 , -0.0037951, 0.0113245 , -0.0665697, -0.1638026, 0.3481516 , 0.3708589 , 0.0720386 , 0.0035912 ],
#      [-0.0030098, 0.0005491 , -0.0013501, 0.0041689 , -0.0276824, -0.094289 , 0.3708589 , 0.9563403 , 0.5361376 , 0.0845869 ],
#      [-0.0002323, 0.0000424 , -0.0001044, 0.0003247 , -0.002249 , -0.0095082, 0.0720386 , 0.5361376 , 0.9997542 , 0.5394018 ],
#      [-0.0000051, 9e-7      , -0.0000023, 0.0000071 , -0.0000497, -0.0002398, 0.0035912 , 0.0845869 , 0.5394018 , 1.0000018 ]])

savedCov =np.array([[ 5.09625632e-01, -3.33066907e-16, -1.66533454e-16, -9.88792381e-17,  3.63207728e-18,  3.44967276e-02, -1.38267210e-18, -7.75055224e-03, -2.00292507e-03, -1.67618574e-04],
[ 0.00000000e+00,  9.99999994e-09,  1.11022302e-16, -8.32667268e-17, -6.76542156e-17, -3.22008045e-17, -9.49820395e-18, -2.85837224e-18, -5.58293767e-19, -4.49786826e-20],
[ 2.77555756e-17,  2.22044605e-16,  1.00000002e-08,  0.00000000e+00, -1.38777878e-16, -5.55111512e-17, -2.14672030e-17, -1.05303136e-17, -2.31807771e-18, -1.90113037e-19],
[-8.67361738e-18,  1.11022302e-16,  2.22044605e-16,  9.99999994e-09, -1.11022302e-16, -2.77555756e-17,  8.67361738e-18,  5.14996032e-18,  1.15450591e-18,  9.46526231e-20],
[-4.00070602e-17, -9.02056208e-17, -8.32667268e-17,  0.00000000e+00,  1.00000001e-08,  1.11022302e-16,  2.77555756e-17, -3.46944695e-18, -1.24683250e-18, -1.07149668e-19],
[ 3.44967276e-02, -5.97395397e-17, -4.85722573e-17,  5.55111512e-17,  0.00000000e+00,  2.66312702e-01,  0.00000000e+00, -1.77597042e-01, -5.69934156e-02, -5.23533037e-03],
[-4.49836699e-18, -1.00784215e-17, -1.35525272e-17,  5.20417043e-18,  2.77555756e-17,  0.00000000e+00,  9.99999994e-09,  0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
[-7.75055224e-03,  6.08385716e-18,  6.93677632e-18, -1.89735380e-18,  0.00000000e+00, -1.77597042e-01,  1.11022302e-16,  6.23591981e-01,  5.22272453e-01,  1.28415894e-01],
[-2.00292507e-03,  9.00048290e-19,  3.02906923e-19, -1.84991996e-18, -2.43945489e-18, -5.69934156e-02,  0.00000000e+00,  5.22272453e-01,  9.81130576e-01,  6.04980983e-01],
[-1.67618574e-04,  7.43067883e-20, -5.46843028e-20, -1.96005409e-19,  1.48230766e-20, -5.23533037e-03,  0.00000000e+00,  1.28415894e-01,  6.04980983e-01,  9.99872740e-01]]) 


samples = np.random.multivariate_normal(mu_s.ravel(), cov_s, 3)















cov3 = np.array([
        [1.00000000e+00, 9.23116346e-01, 7.26149037e-01, 4.86752256e-01, 1.78037300e-01, 1.35335283e-01, 5.61347628e-02, 1.98410947e-02,        5.97602290e-03, 1.53381068e-03, 3.35462628e-04, 6.25215038e-05,        9.92950431e-06, 1.34381228e-06, 1.54975314e-07, 1.52299797e-08,        1.27540763e-09, 9.10147076e-11, 5.53461007e-12, 2.86797501e-13,        1.26641655e-14, 4.76530474e-16, 1.52797997e-17, 4.17501006e-19,        9.72098502e-21],
        [9.23116346e-01, 1.00000000e+00, 9.23116346e-01, 7.26149037e-01, 3.86752256e-01, 2.78037300e-01, 1.35335283e-01, 5.61347628e-02,        1.98410947e-02, 5.97602290e-03, 1.53381068e-03, 3.35462628e-04,        6.25215038e-05, 9.92950431e-06, 1.34381228e-06, 1.54975314e-07,        1.52299797e-08, 1.27540763e-09, 9.10147076e-11, 5.53461007e-12,        2.86797501e-13, 1.26641655e-14, 4.76530474e-16, 1.52797997e-17,        4.17501006e-19], 
        [7.26149037e-01, 9.23116346e-01, 1.00000000e+00, 9.23116346e-01, 6.26149037e-01, 4.86752256e-01, 2.78037300e-01, 1.35335283e-01,        5.61347628e-02, 1.98410947e-02, 5.97602290e-03, 1.53381068e-03,        3.35462628e-04, 6.25215038e-05, 9.92950431e-06, 1.34381228e-06,        1.54975314e-07, 1.52299797e-08, 1.27540763e-09, 9.10147076e-11,        5.53461007e-12, 2.86797501e-13, 1.26641655e-14, 4.76530474e-16,        1.52797997e-17],
        [4.86752256e-01, 7.26149037e-01, 9.23116346e-01, 1.00000000e+00, 8.23116346e-01, 7.26149037e-01, 4.86752256e-01, 2.78037300e-01,        1.35335283e-01, 5.61347628e-02, 1.98410947e-02, 5.97602290e-03,        1.53381068e-03, 3.35462628e-04, 6.25215038e-05, 9.92950431e-06,        1.34381228e-06, 1.54975314e-07, 1.52299797e-08, 1.27540763e-09,        9.10147076e-11, 5.53461007e-12, 2.86797501e-13, 1.26641655e-14,        4.76530474e-16],
        [2.78037300e-01, 4.86752256e-01, 7.26149037e-01, 9.23116346e-01, 0.00000000e+00, 9.23116346e-01, 7.26149037e-01, 4.86752256e-01,        2.78037300e-01, 1.35335283e-01, 5.61347628e-02, 1.98410947e-02,        5.97602290e-03, 1.53381068e-03, 3.35462628e-04, 6.25215038e-05,        9.92950431e-06, 1.34381228e-06, 1.54975314e-07, 1.52299797e-08,        1.27540763e-09, 9.10147076e-11, 5.53461007e-12, 2.86797501e-13,        1.26641655e-14],
        [1.35335283e-01, 2.78037300e-01, 4.86752256e-01, 7.26149037e-01, 8.23116346e-01, 1.00000000e+00, 9.23116346e-01, 7.26149037e-01,        4.86752256e-01, 2.78037300e-01, 1.35335283e-01, 5.61347628e-02,        1.98410947e-02, 5.97602290e-03, 1.53381068e-03, 3.35462628e-04,        6.25215038e-05, 9.92950431e-06, 1.34381228e-06, 1.54975314e-07,        1.52299797e-08, 1.27540763e-09, 9.10147076e-11, 5.53461007e-12,        2.86797501e-13],
        [5.61347628e-02, 1.35335283e-01, 2.78037300e-01, 4.86752256e-01, 6.26149037e-01, 9.23116346e-01, 1.00000000e+00, 9.23116346e-01,        7.26149037e-01, 4.86752256e-01, 2.78037300e-01, 1.35335283e-01,        5.61347628e-02, 1.98410947e-02, 5.97602290e-03, 1.53381068e-03,        3.35462628e-04, 6.25215038e-05, 9.92950431e-06, 1.34381228e-06,        1.54975314e-07, 1.52299797e-08, 1.27540763e-09, 9.10147076e-11,        5.53461007e-12],
        [1.98410947e-02, 5.61347628e-02, 1.35335283e-01, 2.78037300e-01, 3.86752256e-01, 7.26149037e-01, 9.23116346e-01, 1.00000000e+00,        9.23116346e-01, 7.26149037e-01, 4.86752256e-01, 2.78037300e-01,        1.35335283e-01, 5.61347628e-02, 1.98410947e-02, 5.97602290e-03,        1.53381068e-03, 3.35462628e-04, 6.25215038e-05, 9.92950431e-06,        1.34381228e-06, 1.54975314e-07, 1.52299797e-08, 1.27540763e-09,        9.10147076e-11],
        [5.97602290e-03, 1.98410947e-02, 5.61347628e-02, 1.35335283e-01, 1.78037300e-01, 4.86752256e-01, 7.26149037e-01, 9.23116346e-01,        1.00000000e+00, 9.23116346e-01, 7.26149037e-01, 4.86752256e-01,        2.78037300e-01, 1.35335283e-01, 5.61347628e-02, 1.98410947e-02,        5.97602290e-03, 1.53381068e-03, 3.35462628e-04, 6.25215038e-05,        9.92950431e-06, 1.34381228e-06, 1.54975314e-07, 1.52299797e-08,        1.27540763e-09],
        [1.53381068e-03, 5.97602290e-03, 1.98410947e-02, 5.61347628e-02, 0.35335283e-01, 2.78037300e-01, 4.86752256e-01, 7.26149037e-01,        9.23116346e-01, 1.00000000e+00, 9.23116346e-01, 7.26149037e-01,        4.86752256e-01, 2.78037300e-01, 1.35335283e-01, 5.61347628e-02,        1.98410947e-02, 5.97602290e-03, 1.53381068e-03, 3.35462628e-04,        6.25215038e-05, 9.92950431e-06, 1.34381228e-06, 1.54975314e-07,        1.52299797e-08],
        [3.35462628e-04, 1.53381068e-03, 5.97602290e-03, 1.98410947e-02, 4.61347628e-02, 1.35335283e-01, 2.78037300e-01, 4.86752256e-01,        7.26149037e-01, 9.23116346e-01, 1.00000000e+00, 9.23116346e-01,        7.26149037e-01, 4.86752256e-01, 2.78037300e-01, 1.35335283e-01,        5.61347628e-02, 1.98410947e-02, 5.97602290e-03, 1.53381068e-03,        3.35462628e-04, 6.25215038e-05, 9.92950431e-06, 1.34381228e-06,        1.54975314e-07],
        [6.25215038e-05, 3.35462628e-04, 1.53381068e-03, 5.97602290e-03, 0.98410947e-02, 5.61347628e-02, 1.35335283e-01, 2.78037300e-01,        4.86752256e-01, 7.26149037e-01, 9.23116346e-01, 1.00000000e+00,        9.23116346e-01, 7.26149037e-01, 4.86752256e-01, 2.78037300e-01,        1.35335283e-01, 5.61347628e-02, 1.98410947e-02, 5.97602290e-03,        1.53381068e-03, 3.35462628e-04, 6.25215038e-05, 9.92950431e-06,        1.34381228e-06],
        [9.92950431e-06, 6.25215038e-05, 3.35462628e-04, 1.53381068e-03, 4.97602290e-03, 1.98410947e-02, 5.61347628e-02, 1.35335283e-01,        2.78037300e-01, 4.86752256e-01, 7.26149037e-01, 9.23116346e-01,        1.00000000e+00, 9.23116346e-01, 7.26149037e-01, 4.86752256e-01,        2.78037300e-01, 1.35335283e-01, 5.61347628e-02, 1.98410947e-02,        5.97602290e-03, 1.53381068e-03, 3.35462628e-04, 6.25215038e-05,        9.92950431e-06],
        [1.34381228e-06, 9.92950431e-06, 6.25215038e-05, 3.35462628e-04, 0.53381068e-03, 5.97602290e-03, 1.98410947e-02, 5.61347628e-02,        1.35335283e-01, 2.78037300e-01, 4.86752256e-01, 7.26149037e-01,        9.23116346e-01, 1.00000000e+00, 9.23116346e-01, 7.26149037e-01,        4.86752256e-01, 2.78037300e-01, 1.35335283e-01, 5.61347628e-02,        1.98410947e-02, 5.97602290e-03, 1.53381068e-03, 3.35462628e-04,        6.25215038e-05],
        [1.54975314e-07, 1.34381228e-06, 9.92950431e-06, 6.25215038e-05, 2.35462628e-04, 1.53381068e-03, 5.97602290e-03, 1.98410947e-02,        5.61347628e-02, 1.35335283e-01, 2.78037300e-01, 4.86752256e-01,        7.26149037e-01, 9.23116346e-01, 1.00000000e+00, 9.23116346e-01,        7.26149037e-01, 4.86752256e-01, 2.78037300e-01, 1.35335283e-01,        5.61347628e-02, 1.98410947e-02, 5.97602290e-03, 1.53381068e-03,        3.35462628e-04],
        [1.52299797e-08, 1.54975314e-07, 1.34381228e-06, 9.92950431e-06, 5.25215038e-05, 3.35462628e-04, 1.53381068e-03, 5.97602290e-03,        1.98410947e-02, 5.61347628e-02, 1.35335283e-01, 2.78037300e-01,        4.86752256e-01, 7.26149037e-01, 9.23116346e-01, 1.00000000e+00,        9.23116346e-01, 7.26149037e-01, 4.86752256e-01, 2.78037300e-01,        1.35335283e-01, 5.61347628e-02, 1.98410947e-02, 5.97602290e-03,        1.53381068e-03],
        [1.27540763e-09, 1.52299797e-08, 1.54975314e-07, 1.34381228e-06, 8.92950431e-06, 6.25215038e-05, 3.35462628e-04, 1.53381068e-03,        5.97602290e-03, 1.98410947e-02, 5.61347628e-02, 1.35335283e-01,        2.78037300e-01, 4.86752256e-01, 7.26149037e-01, 9.23116346e-01,        1.00000000e+00, 9.23116346e-01, 7.26149037e-01, 4.86752256e-01,        2.78037300e-01, 1.35335283e-01, 5.61347628e-02, 1.98410947e-02,        5.97602290e-03],
        [9.10147076e-11, 1.27540763e-09, 1.52299797e-08, 1.54975314e-07, 0.34381228e-06, 9.92950431e-06, 6.25215038e-05, 3.35462628e-04,        1.53381068e-03, 5.97602290e-03, 1.98410947e-02, 5.61347628e-02,        1.35335283e-01, 2.78037300e-01, 4.86752256e-01, 7.26149037e-01,        9.23116346e-01, 1.00000000e+00, 9.23116346e-01, 7.26149037e-01,        4.86752256e-01, 2.78037300e-01, 1.35335283e-01, 5.61347628e-02,        1.98410947e-02],
        [5.53461007e-12, 9.10147076e-11, 1.27540763e-09, 1.52299797e-08, 0.54975314e-07, 1.34381228e-06, 9.92950431e-06, 6.25215038e-05,        3.35462628e-04, 1.53381068e-03, 5.97602290e-03, 1.98410947e-02,        5.61347628e-02, 1.35335283e-01, 2.78037300e-01, 4.86752256e-01,        7.26149037e-01, 9.23116346e-01, 1.00000000e+00, 9.23116346e-01,        7.26149037e-01, 4.86752256e-01, 2.78037300e-01, 1.35335283e-01,        5.61347628e-02],
        [2.86797501e-13, 5.53461007e-12, 9.10147076e-11, 1.27540763e-09, 0.52299797e-08, 1.54975314e-07, 1.34381228e-06, 9.92950431e-06,        6.25215038e-05, 3.35462628e-04, 1.53381068e-03, 5.97602290e-03,        1.98410947e-02, 5.61347628e-02, 1.35335283e-01, 2.78037300e-01,        4.86752256e-01, 7.26149037e-01, 9.23116346e-01, 1.00000000e+00,        9.23116346e-01, 7.26149037e-01, 4.86752256e-01, 2.78037300e-01,        1.35335283e-01],
        [1.26641655e-14, 2.86797501e-13, 5.53461007e-12, 9.10147076e-11, 0.27540763e-09, 1.52299797e-08, 1.54975314e-07, 1.34381228e-06,        9.92950431e-06, 6.25215038e-05, 3.35462628e-04, 1.53381068e-03,        5.97602290e-03, 1.98410947e-02, 5.61347628e-02, 1.35335283e-01,        2.78037300e-01, 4.86752256e-01, 7.26149037e-01, 9.23116346e-01,        1.00000000e+00, 9.23116346e-01, 7.26149037e-01, 4.86752256e-01,        2.78037300e-01],
        [4.76530474e-16, 1.26641655e-14, 2.86797501e-13, 5.53461007e-12, 8.10147076e-11, 1.27540763e-09, 1.52299797e-08, 1.54975314e-07,        1.34381228e-06, 9.92950431e-06, 6.25215038e-05, 3.35462628e-04,        1.53381068e-03, 5.97602290e-03, 1.98410947e-02, 5.61347628e-02,        1.35335283e-01, 2.78037300e-01, 4.86752256e-01, 7.26149037e-01,        9.23116346e-01, 1.00000000e+00, 9.23116346e-01, 7.26149037e-01,        4.86752256e-01],
        [1.52797997e-17, 4.76530474e-16, 1.26641655e-14, 2.86797501e-13, 5.53461007e-12, 9.10147076e-11, 1.27540763e-09, 1.52299797e-08,        1.54975314e-07, 1.34381228e-06, 9.92950431e-06, 6.25215038e-05,        3.35462628e-04, 1.53381068e-03, 5.97602290e-03, 1.98410947e-02,        5.61347628e-02, 1.35335283e-01, 2.78037300e-01, 4.86752256e-01,        7.26149037e-01, 9.23116346e-01, 1.00000000e+00, 9.23116346e-01,        7.26149037e-01],
        [4.17501006e-19, 1.52797997e-17, 4.76530474e-16, 1.26641655e-14, 2.86797501e-13, 5.53461007e-12, 9.10147076e-11, 1.27540763e-09,        1.52299797e-08, 1.54975314e-07, 1.34381228e-06, 9.92950431e-06,        6.25215038e-05, 3.35462628e-04, 1.53381068e-03, 5.97602290e-03,        1.98410947e-02, 5.61347628e-02, 1.35335283e-01, 2.78037300e-01,        4.86752256e-01, 7.26149037e-01, 9.23116346e-01, 1.00000000e+00,        9.23116346e-01],
        [9.72098502e-21, 4.17501006e-19, 1.52797997e-17, 4.76530474e-16, 1.26641655e-14, 2.86797501e-13, 5.53461007e-12, 9.10147076e-11,        1.27540763e-09, 1.52299797e-08, 1.54975314e-07, 1.34381228e-06,        9.92950431e-06, 6.25215038e-05, 3.35462628e-04, 1.53381068e-03,        5.97602290e-03, 1.98410947e-02, 5.61347628e-02, 1.35335283e-01,        2.78037300e-01, 4.86752256e-01, 7.26149037e-01, 9.23116346e-01,        1.00000000e+00]
        
    ]
    );